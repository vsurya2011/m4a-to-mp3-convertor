# render.yaml

# Defines the services that Render should deploy
services:
  # ---------------------------------------------
  # 1. BACKEND API SERVICE (Docker Web Service)
  #    Handles the M4A to MP3 conversion using FFmpeg
  # ---------------------------------------------
  - type: web
    name: m4a-api-service
    
    # Crucial: Use the Docker runtime to build the environment with FFmpeg
    runtime: docker 
    
    # Points to the folder containing the Dockerfile, package.json, and server.js
    rootDir: backend
    
    # Free plan is sufficient for testing
    plan: free
    
    # Port must match the EXPOSE 3000 in your Dockerfile
    port: 3000

    envVars:
      - key: NODE_ENV
        value: production

  # ---------------------------------------------
  # 2. FRONTEND UI SERVICE (Static Site)
  #    Serves your HTML, CSS, and JavaScript
  # ---------------------------------------------
  - type: static
    name: m4a-ui-static
    
    # Points to the folder containing index.html, script.js, and style.css
    rootDir: frontend
    
    # Static sites usually have no build command
    buildCommand: ""
    
    # Path where the final static assets are located (same as rootDir here)
    publishPath: frontend